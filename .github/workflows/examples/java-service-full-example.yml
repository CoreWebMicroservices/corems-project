# Full-featured CI example with all optional features
# Shows how to enable Docker, Maven artifacts, and SonarQube

name: CI (Full Features)

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]
  workflow_dispatch:

jobs:
  build-and-test:
    uses: CoreWebMicroservices/corems-project/.github/workflows/java-service-ci.yml@main
    with:
      service-name: user-ms  # Change to your service name
      java-version: '25'
      
      # Enable on main branch only
      publish-artifacts: ${{ github.ref == 'refs/heads/main' }}
      build-docker: ${{ github.ref == 'refs/heads/main' }}
      push-docker: ${{ github.ref == 'refs/heads/main' }}
      run-sonarqube: ${{ github.ref == 'refs/heads/main' }}
      
    secrets:
      github-token: ${{ secrets.GITHUB_TOKEN }}
      docker-username: ${{ secrets.DOCKER_USERNAME }}
      docker-password: ${{ secrets.DOCKER_PASSWORD }}
      sonar-token: ${{ secrets.SONAR_TOKEN }}
      sonar-host-url: ${{ secrets.SONAR_HOST_URL }}
